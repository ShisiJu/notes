# 数据库索引 - 索引简介

本节很多内容来自 [pg数据库的官方文档](https://www.postgresql.org/files/documentation/pdf/13/postgresql-13-A4.pdf)

## 索引简介

### 索引是什么

索引是一种常用提高数据库性能的方式. 索引能够帮助数据库快速地找到特定的数据行;
但是索引也会增加整个数据库系统的 开销 (overhead)，所以应该明智地使用它们。
 
### 为什么要有数据库索引

答: 提高查询效率

我们在数据准备中, 创建了 product 表;

```sql
SELECT * FROM product WHERE id = 12311
```

如果没有主键的索引, 数据库不得不扫描整个 product 表, 一行一行地找;

就如上面的sql, id = 12311 只有一条; 
但是, 数据库仍然要扫描整个表; 这显然是一种低效的查询方式; 

但是, id 上有索引, 它可以使用更为高效的方式去定位到 id = 12311 的数据行;
例如, 它可以仅仅在索引的搜索树上进行几次查询, 就能够得到数据;

索引创建之后, 不需要有更多的操作了; 当表有变化时, 数据库会更新索引;
并且, 数据库在它认为使用`索引比扫描全表更高效时`, 会选择使用索引;

索引同时也可以加快 `UPDATE` 和 `DELETE` 命令.
索引此外还使用在 `join` 查询中. 如果 join 的条件中有索引, 那么会显著提升查询效率;

但是, 索引同时也是一种负担. 对于不常使用的索引, 应该删掉;

### 什么情况下不适合加索引


答: 
尽管索引可以提高数据库的查询效率; 
但是, 索引也会降低数据库的性能. 

下面的情况下, 应该避免使用索引;

- 不应该在`小表`上加索引
- `数据重复`且`分布平均`的字段 (例如: 性别)
- 频繁修改的表或者列
- 索引不应该用于很多 null 的列.
